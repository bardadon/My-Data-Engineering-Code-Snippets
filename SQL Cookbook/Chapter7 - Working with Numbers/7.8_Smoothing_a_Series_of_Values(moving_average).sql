select 
    empno,
    sal,
    AVG(sal) over(ORDER BY sal) as running_avg,
    LAG(sal, 1) over(ORDER BY sal ) as lag1,
    LAG(sal, 2) over(ORDER BY sal ) as lag2,
    (sal + (LAG(sal, 2) over(ORDER BY sal )) + (LAG(sal, 1) over(ORDER BY sal ))) / 3 as Moving_Average_3
from emp
LIMIT 10;

/*
"empno","sal","running_avg","lag1","lag2","moving_average_3"
7900,1140,"1140.0000000000000000","","",""
7369,1152,"1146.0000000000000000",1140,"",""
7654,1250,"1198.0000000000000000",1152,1140,1180
7521,1250,"1198.0000000000000000",1250,1152,1217
7934,1300,"1218.4000000000000000",1250,1250,1266
7876,1320,"1235.3333333333333333",1300,1250,1290
7844,1500,"1273.1428571428571429",1320,1300,1373
7499,1600,"1314.0000000000000000",1500,1320,1473
7782,2450,"1440.2222222222222222",1600,1500,1850
7698,2850,"1581.2000000000000000",2450,1600,2300
*/

